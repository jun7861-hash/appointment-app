'use client';

import { useState } from 'react';
import Link from 'next/link';
import { useSnapshot } from 'valtio';

import { store } from '@/store';
import { toggleSidebar } from '@/store/actions';
import './index.scss';

type Item = {
  logo: React.ReactNode;
  title: string;
  isActive: boolean;
  path: string;
};

type Props = {
  items: Array<Item>;
};

const Sidebar = (props: Props) => {
  const {
    sidebar: { minimize },
  } = useSnapshot(store);
  const { items } = props ?? [];
  const [menuItems, setMenuItems] = useState<Array<Item>>(items);

  const handleSelectItem = (index: number) => {
    const updatedMenuItems = menuItems.map((item, i) => ({
      ...item,
      isActive: i === index,
    }));

    setMenuItems(updatedMenuItems);
  };

  return (
    <aside style={{ maxWidth: !minimize ? '240px' : '120px' }}>
      <div
        className={`minimizer ${!minimize ? 'active' : ''}`}
        style={{ color: '#fff' }}
        onClick={toggleSidebar}
      >
        <svg
          width="20"
          height="20"
          viewBox="0 0 20 20"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M3.57743 15.5791C3.42121 15.4229 3.33345 15.2109 3.33345 14.99C3.33345 14.769 3.42121 14.5571 3.57743 14.4008L7.98827 9.98996L3.57743 5.57913C3.42564 5.42196 3.34164 5.21146 3.34354 4.99296C3.34544 4.77447 3.43308 4.56546 3.58759 4.41095C3.74209 4.25644 3.9511 4.1688 4.1696 4.1669C4.3881 4.165 4.5986 4.249 4.75577 4.4008L9.75577 9.4008C9.91199 9.55707 9.99976 9.76899 9.99976 9.98996C9.99976 10.2109 9.91199 10.4229 9.75577 10.5791L4.75577 15.5791C4.59949 15.7354 4.38757 15.8231 4.1666 15.8231C3.94563 15.8231 3.73371 15.7354 3.57743 15.5791ZM8.57743 15.5791C8.42121 15.4229 8.33345 15.2109 8.33345 14.99C8.33345 14.769 8.42121 14.5571 8.57743 14.4008L12.9883 9.98996L8.57743 5.57913C8.42564 5.42196 8.34164 5.21146 8.34354 4.99296C8.34544 4.77447 8.43308 4.56546 8.58759 4.41095C8.74209 4.25644 8.9511 4.1688 9.1696 4.1669C9.3881 4.165 9.5986 4.249 9.75577 4.4008L14.7558 9.4008C14.912 9.55707 14.9998 9.76899 14.9998 9.98996C14.9998 10.2109 14.912 10.4229 14.7558 10.5791L9.75577 15.5791C9.59949 15.7354 9.38757 15.8231 9.1666 15.8231C8.94563 15.8231 8.73371 15.7354 8.57743 15.5791Z"
            fill="white"
          />
        </svg>
      </div>
      <div className="logo-area">
        <span className="logo">
          <svg
            width="37"
            height="36"
            viewBox="0 0 37 36"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M12.8431 0C10.8124 0 8.86487 0.806703 7.42893 2.24264L0.5 9.17153V12.3431C0.5 14.5839 1.4625 16.5998 2.99661 18C1.4625 19.4002 0.5 21.4161 0.5 23.6568V26.8284L7.42893 33.7574C8.86487 35.1933 10.8124 36 12.8431 36C15.0839 36 17.0998 35.0375 18.5 33.5034C19.9002 35.0375 21.9161 36 24.1569 36C26.1876 36 28.1351 35.1933 29.5711 33.7574L36.5 26.8284V23.6568C36.5 21.4161 35.5375 19.4002 34.0034 18C35.5375 16.5998 36.5 14.5839 36.5 12.3431V9.17153L29.5711 2.24264C28.1351 0.806703 26.1876 0 24.1569 0C21.9161 0 19.9002 0.962493 18.5 2.49661C17.0998 0.962493 15.0839 0 12.8431 0ZM23.6829 18C23.5966 17.9212 23.5119 17.8403 23.4289 17.7573L18.5 12.8284L13.5711 17.7573C13.4881 17.8403 13.4034 17.9212 13.3171 18C13.4034 18.0787 13.4881 18.1596 13.5711 18.2426L18.5 23.1716L23.4289 18.2426C23.5119 18.1596 23.5966 18.0787 23.6829 18ZM20.5 26.8284V28.3431C20.5 30.3627 22.1373 32 24.1569 32C25.1267 32 26.0569 31.6147 26.7426 30.9289L32.5 25.1715V23.6568C32.5 21.6372 30.8628 20 28.8432 20C27.8733 20 26.9432 20.3853 26.2574 21.0711L20.5 26.8284ZM16.5 26.8284L10.7426 21.0711C10.0568 20.3853 9.12672 20 8.15686 20C6.13723 20 4.5 21.6372 4.5 23.6568V25.1715L10.2573 30.9289C10.9431 31.6147 11.8733 32 12.8431 32C14.8627 32 16.5 30.3627 16.5 28.3431V26.8284ZM16.5 7.65686V9.17153L10.7426 14.9289C10.0568 15.6147 9.12672 16 8.15686 16C6.13723 16 4.5 14.3627 4.5 12.3431V10.8284L10.2573 5.07107C10.9431 4.38527 11.8733 4 12.8431 4C14.8627 4 16.5 5.63723 16.5 7.65686ZM26.2574 14.9289L20.5 9.17153V7.65686C20.5 5.63723 22.1373 4 24.1569 4C25.1267 4 26.0569 4.38527 26.7426 5.07107L32.5 10.8284V12.3431C32.5 14.3627 30.8628 16 28.8432 16C27.8733 16 26.9432 15.6147 26.2574 14.9289Z"
              fill="#FF630B"
            />
          </svg>
        </span>
        {!minimize && <span className="logo-text">LOREM</span>}
      </div>
      <div className="content">
        <ul>
          {menuItems.map((item: Item, index: number) => (
            <li
              key={index}
              className={`item ${item.isActive ? 'active' : ''}`}
              onClick={() => handleSelectItem(index)}
            >
              <Link
                href={item.path}
                style={{ justifyContent: !minimize ? 'unset' : 'center' }}
              >
                <span className="icon">{item.logo}</span>
                {!minimize && <span className="title">{item.title}</span>}
              </Link>
            </li>
          ))}
        </ul>
      </div>
      <div className="side-footer">
        <div className="area">
          <div className="logo">
            <svg
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M6.8573 0C5.7291 0 4.64715 0.448169 3.84941 1.24591L0 5.09529V6.85729C0 8.10214 0.53472 9.22209 1.387 9.99999C0.53472 10.7779 0 11.8978 0 13.1427V14.9047L3.84941 18.7541C4.64715 19.5518 5.7291 20 6.8573 20C8.10215 20 9.2221 19.4653 10 18.613C10.7779 19.4653 11.8979 20 13.1427 20C14.2709 20 15.3528 19.5518 16.1506 18.7541L20 14.9047V13.1427C20 11.8978 19.4653 10.7779 18.613 9.99999C19.4653 9.22209 20 8.10214 20 6.85729V5.09529L16.1506 1.24591C15.3528 0.448169 14.2709 0 13.1427 0C11.8979 0 10.7779 0.534718 10 1.387C9.2221 0.534718 8.10215 0 6.8573 0ZM12.8794 9.99999C12.8315 9.95624 12.7844 9.91129 12.7383 9.86519L10 7.12689L7.2617 9.86519C7.2156 9.91129 7.16855 9.95624 7.1206 9.99999C7.16855 10.0437 7.2156 10.0887 7.2617 10.1348L10 12.8731L12.7383 10.1348C12.7844 10.0887 12.8315 10.0437 12.8794 9.99999ZM11.1111 14.9047V15.7462C11.1111 16.8682 12.0207 17.7778 13.1427 17.7778C13.6815 17.7778 14.1983 17.5637 14.5793 17.1827L17.7778 13.9842V13.1427C17.7778 12.0207 16.8682 11.1111 15.7462 11.1111C15.2074 11.1111 14.6906 11.3251 14.3097 11.7061L11.1111 14.9047ZM8.8889 14.9047L5.69035 11.7061C5.30935 11.3251 4.79262 11.1111 4.25381 11.1111C3.13179 11.1111 2.22222 12.0207 2.22222 13.1427V13.9842L5.42075 17.1827C5.80175 17.5637 6.3185 17.7778 6.8573 17.7778C7.9793 17.7778 8.8889 16.8682 8.8889 15.7462V14.9047ZM8.8889 4.25381V5.09529L5.69035 8.29384C5.30935 8.67484 4.79262 8.88889 4.25381 8.88889C3.13179 8.88889 2.22222 7.97929 2.22222 6.85729V6.01579L5.42075 2.81726C5.80175 2.43626 6.3185 2.22222 6.8573 2.22222C7.9793 2.22222 8.8889 3.13179 8.8889 4.25381ZM14.3097 8.29384L11.1111 5.09529V4.25381C11.1111 3.13179 12.0207 2.22222 13.1427 2.22222C13.6815 2.22222 14.1983 2.43626 14.5793 2.81726L17.7778 6.01579V6.85729C17.7778 7.97929 16.8682 8.88889 15.7462 8.88889C15.2074 8.88889 14.6906 8.67484 14.3097 8.29384Z"
                fill="#FF630B"
              />
            </svg>
          </div>
          <p className="copyright">Â© Lorem 2023</p>
        </div>
      </div>
    </aside>
  );
};

export default Sidebar;
